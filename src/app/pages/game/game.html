<div class="game-container" *ngIf="state$ | async as state">

  <!-- HEADER -->
  <header class="game-header">
    <h1>ğŸ® Team Quiz Night</h1>

    <div class="player-info">
      ğŸ‘¤ {{ getCurrentPlayer(state)?.name }}
      <span class="team">({{ getCurrentPlayer(state)?.team }})</span>
    </div>

    <div *ngIf="state.hostId === socket.playerId" class="share-box">
      <span>{{ origin }}/join/{{ socket.sessionId }}</span>
      <button (click)="copyLink()">ğŸ“‹ Copy Invite</button>
    </div>
  </header>

  <!-- ROUND INFO -->
  <div class="round-info" *ngIf="state.roundName">
    â­ Round: {{ state.roundName }}
  </div>

  <!-- QUESTION FOCUS AREA -->
  <section class="question-area">
    <div class="question-card" *ngIf="state.question; else waiting">
      {{ state.question }}
    </div>

    <ng-template #waiting>
      <div class="question-card waiting">
        â³ Waiting for next questionâ€¦
      </div>
    </ng-template>
  </section>

  <!-- BUZZER AREA -->
  <section class="action-area">
    <button
      *ngIf="state.phase !== 'ENDED'"
      class="buzz-btn"
      [disabled]="state.phase !== 'QUESTION_LIVE' || !state.buzzerEnabled"
      (click)="buzz()">
      ğŸ”´ BUZZ NOW
    </button>

    <div class="winner-banner" *ngIf="getWinner(state) as winner">
      âš¡ {{ winner.name }} ({{ winner.team }}) buzzed first!
    </div>
  </section>

  <!-- TEAM SCOREBOARD -->
  <section class="scores-area">
    <h3>ğŸ† Team Scores</h3>
    <div class="scores-grid">
      <div class="team-score" *ngFor="let team of getTeamScores(state.players) | keyvalue">
        <div class="team-name">{{ team.key }}</div>
        <div class="team-points">{{ team.value }}</div>
      </div>
    </div>
  </section>

  <!-- HOST CONTROLS -->
  <section *ngIf="state.hostId === socket.playerId" class="host-panel">
    <h3>ğŸ‘‘ Host Controls</h3>

    <button *ngIf="state.phase === 'WAITING'" (click)="nextQuestion()">
      â–¶ï¸ Start Next Question
    </button>

    <button *ngIf="state.phase === 'QUESTION_DISPLAYED'" (click)="enableBuzzers()">
      ğŸ”” Enable Buzzers
    </button>

    <div *ngIf="state.currentBuzzPlayerId" class="answer-controls">
      <button class="correct" (click)="markCorrect()">âœ… Correct</button>
      <button class="wrong" (click)="markWrong()">âŒ Wrong</button>
    </div>

    <button class="end-btn" (click)="endGame()">ğŸ End Game</button>
  </section>

  <!-- GAME OVER -->
  <section *ngIf="state.phase === 'ENDED'" class="game-over">
    <h1>ğŸ Game Over</h1>
    <h2>ğŸ† {{ getWinningTeam(state.players) }} Wins!</h2>
  </section>

</div>

