<div class="game-container" *ngIf="state$ | async as state">

  <!-- HEADER -->
  <header class="game-header">
    <h1>ğŸ® Team Quiz Night</h1>

    <div *ngIf="state.hostId === socket.playerId" class="share-box">
      <span>{{ origin }}/join/{{ socket.sessionId }}</span>
      <button (click)="copyLink()">ğŸ“‹ Copy</button>
    </div>
  </header>

  <!-- QUESTION AREA -->
  <section class="question-area">
    <h2 *ngIf="state.question; else waiting">
      {{ state.question }}
    </h2>

    <ng-template #waiting>
      <h2>Waiting for next questionâ€¦</h2>
    </ng-template>
  </section>

  <!-- ACTION AREA -->
  <section class="action-area">

    <!-- BUZZ BUTTON -->
    <button
      *ngIf="state.phase !== 'ENDED'"
      class="buzz-btn"
      [disabled]="state.phase !== 'QUESTION_LIVE' || !state.buzzerEnabled"
      (click)="buzz()"
    >
      ğŸ”´ BUZZ
    </button>

    <!-- WINNER -->
    <div class="winner-banner" *ngIf="getWinner(state) as winner">
      ğŸ”¥ <b>{{ winner.name }}</b> ({{ winner.team }}) buzzed first!
    </div>

  </section>

  <!-- SCORES -->
  <section class="scores-area">
    <h3>ğŸ† Team Scores</h3>
    <ul>
      <li *ngFor="let team of getTeamScores(state.players) | keyvalue">
        {{ team.key }} â€” <b>{{ team.value }}</b>
      </li>
    </ul>
  </section>

  <!-- HOST PANEL -->
  <section *ngIf="state.hostId === socket.playerId" class="host-panel">

    <h3>ğŸ‘‘ Host Controls</h3>

    <button *ngIf="state.phase === 'WAITING'" (click)="nextQuestion()">
      â–¶ï¸ Start Next Question
    </button>

    <button
      *ngIf="state.phase === 'QUESTION_DISPLAYED'"
      (click)="enableBuzzers()"
    >
      ğŸ”” Enable Buzzers
    </button>

    <div *ngIf="state.currentBuzzPlayerId">
      <button class="correct" (click)="markCorrect()">âœ… Correct</button>
      <button class="wrong" (click)="markWrong()">âŒ Wrong</button>
    </div>

    <button (click)="endGame()">ğŸ End Game</button>

  </section>

  <!-- GAME OVER -->
  <section *ngIf="state.phase === 'ENDED'" class="game-over">
    <h1>ğŸ Game Over</h1>
    <h2>ğŸ† {{ getWinningTeam(state.players) }} Wins!</h2>
  </section>

</div>
